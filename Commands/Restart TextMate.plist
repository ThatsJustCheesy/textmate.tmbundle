<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>beforeRunningCommand</key>
	<string>nop</string>
	<key>command</key>
	<string>{
app_path=$(
    ps -axw -o command -p $PPID | \
    tail -n 1 | \
    sed -e 's#^\(/.*\)/Contents.*$#\1#g' \
)

osascript -e 'tell app "TextMate" to quit'

for (( i = 0; i &lt; 300; i++ )); do
    if [[ ! -n $(ps -xc|grep 'TextMate$') ]]; then
        break;
    else
        sleep .2;
    fi
done

if [[ ! -n $(ps -xc|grep 'TextMate$') ]]; then
    open "$app_path"
fi
} &amp;&gt;/dev/null &amp;</string>
	<key>input</key>
	<string>none</string>
	<key>keyEquivalent</key>
	<string>^@q</string>
	<key>name</key>
	<string>Restart</string>
	<key>output</key>
	<string>discard</string>
	<key>uuid</key>
	<string>E5142394-B07A-11D9-8EC4-000D93589AF6</string>
</dict>
</plist>
